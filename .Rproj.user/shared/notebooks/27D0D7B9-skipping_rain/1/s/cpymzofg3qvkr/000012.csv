"0",""
"0","# simulations"
"0",""
"0","gravities_ <- gravities %>% filter(objects %in% c(""Terre"", ""Mars"", ""Lune""))"
"0","g <- gravities_$gravity"
"0",""
"0","ds_f <- data.frame()"
"0",""
"0","for (i in g){"
"0","  "
"0","  v_t <- (i*rho_w*d^2)/(18*mu_air) # m.s^-1"
"0","  drop <- data.frame(drop_diameter_m = d, speed = v_t, gravity = i)"
"0","  ds <- expand.grid(rope_sections_m = y_g, speed = v_t)"
"0","  ds2 <- left_join(ds, drop, by = ""speed"")"
"0","  "
"0","  ds2 <- ds2 %>% mutate(n = speed/rope_sections_m,"
"0","                        drop_diameter_mm = drop_diameter_m*1000,"
"0","                        rope_sections_mm = round(rope_sections_m*1000, 2),"
"0","                        drop_diameter_m = as.factor(drop_diameter_m),"
"0","                        drop_diameter_mm = as.factor(round(drop_diameter_mm, 2)))"
"0","  "
"0","  ds_f <- rbind(ds2, ds_f)"
"0","  "
"0","}"
"0",""
"0","ds_f <- full_join(ds_f, gravities_, by = ""gravity"")"
"0",""
"0","# plot the results"
"0",""
"0","ggplot(data = ds_f, aes(y = n, x = rope_sections_mm, col = drop_diameter_mm)) + "
"0","  geom_line() +"
"0","  geom_hline(aes(yintercept = max_level, linetype = ""Cen.X record""), colour = 'black') +"
"0","  scale_linetype_manual(name = ""Limite"","
"0","                        values = c(2),"
"0","                        guide = guide_legend(override.aes = list(color = c(""black"")))) +"
"0","  scale_y_log10() +"
"0","  facet_grid(.~ objects) +"
"0","  "
"0","  labs(color = ""Diamètre gouttes (mm)"", "
"0","       y = ""Nombre de tours par seconde"", "
"0","       x = ""Diamètre de la corde (mm)"") +"
"0","  theme_bw()"
"0",""
