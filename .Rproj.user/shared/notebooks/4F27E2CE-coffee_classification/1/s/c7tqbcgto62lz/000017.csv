"0",""
"0","# create a data partition"
"0",""
"0","set.seed(1)"
"0","test_index <- createDataPartition(y = surfcol$type, times = 1, p = 0.5, list = FALSE)"
"0",""
"0","test_set <- surfcol[test_index, ]"
"0","train_set <- surfcol[-test_index, ]"
"0",""
"0","# build the model on the train set"
"0",""
"0","fit <- train_set %>%"
"0","  mutate(y = ifelse(type == ""ded"", 1, 0)) %>%"
"0","  lm(y ~ intensity + surface, data = .)"
"0",""
"0","# assess the model on the test set"
"0",""
"0","p_hat <- predict(fit, newdata = test_set)"
"0","y_hat <- factor(ifelse(p_hat > 0.5, ""ded"", ""egn""))"
"0",""
"0","# plot a segregation line"
"0",""
"0","surfcol$prob <- p_hat"
"0",""
"0","beta_0 <- fit$coefficients[1]"
"0","beta_1 <- fit$coefficients[2]"
"0","beta_2 <- fit$coefficients[3]"
"0",""
"0","surfcol <- surfcol %>% mutate(y_05 = (0.5 - beta_0 - beta_1*intensity)/beta_2)"
"0",""
"0","ggplot(surfcol, aes(y = surface, x = intensity, col = type)) +"
"0","  geom_point() +"
"0","  geom_line(aes(y = y_05,"
"0","                x = intensity,"
"0","                linetype = ""p(Intensity, Surface) = 0.5""), "
"0","            col = ""black"") +"
"0","  scale_linetype_manual(name = ""boundary"","
"0","                        values = c(2),"
"0","                        guide = guide_legend(override.aes = list(color = c(""black"")))) +"
"0","  theme_bw() +"
"0","  labs(y = ""Surface (pixel count)"", x = ""Color intensity (0 to 255)"")"
"0",""
